# ExtractSeal Desktop (Python)

一个用于 **从文档图片中自动提取红色圆形公章** 的 Windows 桌面工具。
本项目基于前端项目 **[wu529778790/extractSeal](https://github.com/wu529778790/extractSeal)** 的核心算法思想，
将其 **完整复刻并重构为 Python 版本**，并提供 **桌面 GUI（Tkinter）**，支持 **截图粘贴 / 文件选择 / 单个结果导出**，最终可打包为 **Windows 可执行程序（exe）**。

---

## ✨ 功能特性

* ✅ 自动从图片中提取 **红色圆形公章**
* ✅ 支持 **红章与黑色文字融合** 的复杂扫描件场景
* ✅ 支持 **选择图片文件** 或 **直接粘贴截图（Ctrl+V）**
* ✅ 可视化显示：

  * 原图
  * 颜色提取结果
  * 圆检测结果
  * 单个公章裁剪预览
* ✅ 支持 **单个检测结果单独导出 PNG（透明背景）**
* ✅ 纯本地运行，无需网络
* ✅ 可打包为 **任意 Windows 环境可运行的 exe**

---

## 🧠 核心算法说明（重要）

本项目算法 **并不依赖深度学习**，而是采用一套**稳定、可解释、工程友好**的传统视觉方法：

### 1️⃣ 颜色分割（HSV）

* 将图片从 RGB 转换到 HSV 颜色空间
* 以 **目标红色** 为中心，在 Hue 上取 ±阈值
* 同时限制：

  * 饱和度 S ≥ 阈值
  * 亮度 V ≥ 阈值
* **关键点**：
  即使红章被黑色文字覆盖，只要像素仍保持“红色属性”，仍可被识别

### 2️⃣ 红色跨 0/180 边界处理

* 针对红色在 HSV 中跨越 0° / 180° 的特殊情况
* 通过双区间 mask 合并，避免红色被错误切断

### 3️⃣ 圆形检测（HoughCircles）

* 对颜色分割结果进行：

  * 灰度化
  * 高斯模糊
* 使用霍夫圆变换检测圆形区域
* 允许：

  * 圆不完整
  * 被文字遮挡
  * 边缘断裂

### 4️⃣ 几何裁剪与透明化

* 根据检测到的圆参数生成 **理想圆形 mask**
* 裁剪圆形区域
* 圆外区域设为透明
* 输出 **透明背景 PNG**

> ⚠️ 注意：
> 本算法并非“还原真实印章纹理”，
> 而是 **在工程上可靠地提取“可用的完整公章图像”**。

---

## 📦 项目结构

```text
.
├── app_tk.py        # Tkinter 桌面 UI（文件选择 / 粘贴 / 预览 / 导出）
├── seal_core.py     # 核心算法逻辑（与 UI 解耦）
├── README.md
```

* `seal_core.py`

  * 可独立作为库使用
  * 可接入批处理 / 服务端 / 其他 UI

* `app_tk.py`

  * 纯 GUI 层
  * 不包含任何算法细节

---

## 🖥️ 使用方式

### 方式一：选择图片文件

1. 点击「选择图片」
2. 选择扫描件 / 拍照图片
3. 点击「提取」
4. 在检测结果列表中选择一个公章
5. 点击「保存选中」

### 方式二：直接粘贴截图

1. 使用截图工具截图并 **复制到剪贴板**
2. 回到程序，按 **Ctrl + V**
3. 点击「提取」
4. 后续流程同上

---

## 🛠️ 环境依赖（开发）

```bash
pip install -r requirements.txt
```

> Tkinter 为 Python 标准库，Windows 默认自带。

---

## 📦 打包为 Windows 可执行程序

使用 **PyInstaller**：

```bash
pyinstaller --noconfirm --windowed --name ExtractSealWin \
  --collect-all cv2 \
  app_tk.py
```

生成文件位于：

```text
dist/ExtractSealWin/ExtractSealWin.exe
```

可直接在 **未安装 Python 的 Windows 机器** 上运行。

---

## 🔗 原项目致谢

本项目的算法思想来源于前端项目：

* **extractSeal**
  [https://github.com/wu529778790/extractSeal](https://github.com/wu529778790/extractSeal)

原项目使用 **OpenCV.js** 在浏览器中实现红色公章提取，本项目在充分理解其算法逻辑后，将其 **等价复刻为 Python + OpenCV 实现**，并扩展为桌面端应用。

---

## 📌 适用场景

* 合同 / 协议公章提取
* OCR 前处理
* 文档归档系统
* 内部工具 / 自动化脚本
* 不适合引入深度学习模型的轻量场景

---

## 📄 License
MIT  
本项目仅用于学习与工程实践示例，
请在实际业务或分发前确认原项目及相关依赖的许可证要求。
